# 무빙

## 프로젝트 소개

- 이사 소비자와 이사 전문가 매칭 서비스
- 🗓️ 프로젝트 기간: 2025.02.18 ~ 2025.04.10

# 풀스택 3기 파트4 2팀

## 링크

- [팀 문서](https://weak-lancer-c84.notion.site/1a06152b67c6817ebfd7c32764490c9f?v=1a06152b67c681a39668000c39caa079&pvs=4)
- [배포 링크](https://api.moving-app.site)

## 팀원 구성

| 이름   | Github                            |
| ------ | --------------------------------- |
| 강대원 | https://github.com/Daewony        |
| 김태훈 | https://github.com/Zero5338       |
| 김현묵 | https://github.com/kimhyunmook    |
| 배진한 | https://github.com/Jin-coding-333 |
| 전준기 | https://github.com/JeonJun02      |
| 정유석 | https://github.com/yousuk88       |
| 최종훈 | https://github.com/jonghun4       |
| 최혜지 | https://github.com/heziss         |
| 함헌규 | https://github.com/heonq          |

## 기술 스택

- Express.js
- Typescript
- Prisma ORM
- Postgre SQL
- Bcrypt
- Superstruct
- EC2
- RDS
- S3
- JWT

---

## 팀원별 구현 기능 상세

## 프로젝트 DB ERD

![image](https://github.com/user-attachments/assets/690d0f45-6d4a-420f-b4b7-bc7aadbfc5de)

### 강대원

#### 백엔드 초기 프로젝트 설정

- ESLint, Prettier 설정을 통한 코드 컨벤션 통일
- 폴더 구조 설계 및 스크립트 명령어 정의로 개발 환경 표준화

#### ERD 및 Prisma 기반 DB 설계

- 요구사항 분석을 통해 테이블 정의 및 테이블 간 관계 설정
- 중복 데이터를 최소화하는 정규화 설계 적용
- Prisma를 활용한 스키마 작성 및 DB 관리

#### API 개발

#### 일반 사용자 견적 작성 가능 여부 조회 API

- 고객 ID 유효성 검증 및 최근 견적 상태 조회
- 해당 유저의 최근 견적을 조회한 후, 견적 상태가 '견적 취소' 또는 '이사 완료' 상태 시 신규 견적 작성 가능
- 그 외 상태에서는 기존 견적 요약 정보 제공

#### 일반 사용자 견적 신청 API

- 고객 ID 및 견적 작성 가능 여부 검증
- 이사일 유효성 검사
- 견적 신청 데이터 생성 로직 구현

#### 기사님 견적 제출 API

- 기사 ID 및 중복 제출 여부 검증
- 견적 가격 및 내용 저장
- 견적 요청 고객에게 알림 전송
- 트랜잭션 적용으로 데이터 무결성 보장

#### 기사님 지정 견적 요청에 대한 반려 API

- 견적 및 기사 ID 유효성 검증
- 기존 반려 기록 존재 여부 확인
- 반려 기록 생성 및 고객 알림 전송
- 트랜잭션 적용

#### 견적 요청 목록 조회 API

- 기사 ID 유효성 검증
- Offset 기반 페이지네이션 적용
- 이미 제출한 견적 및 반려한 견적 제외 조건 추가

####

### 김태훈

### 김현묵

### 배진한

### 전준기

### 정유석

### 최종훈

### 최혜지

### 함헌규

#### 백엔드 배포 설정

- EC2에 백엔드 저장소를 clone하여 pm2를 사용해 지속적으로 실행, nginx를 통해 리버스 프록시 설정하여 서버 URL로 접속 시 실행중인 서버에 접속하도록 설정, DB는 RDS postgre SQL을 사용

#### S3+Cloudfront로 정적 데이터 관리

- 파라미터로 파일 이름을 입력받아 업로드에 사용할 Presigned Url과 업로드된 파일의 URL을 응답

#### 로그인/회원가입 API

- JWT에 회원의 ID와 프로필 ID(일반/기사 회원에 해당하는 ID) 그리고 유저 타입을 저장하고 쿠키를 통해 응답

#### OAuth API 구현

- 네이버,카카오,구글 계정을 사용한 로그인/회원가입 API 구현
- 동일한 이메일로 다른 회원유형(일반/기사님)계정이 존재할 경우 알림을 표시하도록 처리

#### 리프레쉬 토큰 API

- 전달받은 리프레쉬 토큰을 검증하고 액세스 토큰을 갱신하여 쿠키를 통해 응답

#### 유저 정보 추출 미들웨어

- 쿠키에 담긴 JWT를 decode하여 req?.appUser 객체에 userId,roleId,userType 값을 할당하는 미들웨어 구현

#### 유저 타입 검증 미들웨어

- API마다 호출 가능한 유저 타입이 달라지는데 req?.appUser에 저장된 userType을 통해서 호출 가능한 타입의 사용자인지 확인하고 아닐 경우 401 상태와 메시지를 응답하는 미들웨어 구현

#### 견적 요청 취소 API

- 견적 요청의 ID를 파라미터로 입력하여 해당 견적 요청을 취소
- API를 호출한 사용자가 해당 견적 요청을 신청한 사용자가 아닐 경우 401 코드와 메시지를 응답
- 견적 요청의 상태가 QUOTE_REQUESTED가 아닌 경우 409 코드와 메시지를 응답

#### 일반 사용자가 조회하는 견적 상세 정보 API

#### 기사 사용자가 보낸 견적 목록을 조회하는 API

#### 기사 사용자가 조회하는 견적 상세 정보 API
